---
title: "Avoiding Delays on the TTC Streetcar: A Data-Driven Guide for Smarter Travel"
author: 
  - Khushaal Nandwani
thanks: "Code and data are available at: https://github.com/khushaal-nandwani/ttc-avoiding-delays"
date: today
date-format: long
abstract: "This study examines delays in the Toronto Transit Commission (TTC) streetcar system, analyzing patterns based on time, day, direction, and streetcar line. The data reveals that eastbound and westbound streetcars face more delays, particularly during early mornings and late evenings. These findings can assist riders in planning routes to avoid delays and help improve transit scheduling."
format: pdf
number-sections: true
bibliography: references.bib
---


# Introduction

The Toronto Transit Commission (TTC) streetcar system is one of the city’s most iconic and frequently used public transit services. However, streetcar delays have been a persistent issue for riders, often resulting in inconvenience and unpredictable travel times. There is a messaging service available, where one can SMS on a number and is informed about the next TTC arriving. However, this is not always accurate. These delays can be influenced by various factors, including the time of day, the direction of travel, and external circumstances like construction or traffic congestion. Understanding the patterns and causes of these delays can help both daily commuters and occasional travelers optimize their routes and avoid unnecessary disruptions.

In this paper, we explore the patterns of delays in the TTC streetcar network by analyzing data provided by Open Data Toronto by @citeOpenDataToronto. Specifically, we aim to identify the times of day, days of the week, and streetcar lines that are most prone to delays. Additionally, we investigate the impact of streetcar direction on delay frequency and length, offering practical insights that can help riders make informed travel decisions.

The remainder of this paper is structured as follows. First, we present the dataset and methodology used in our analysis. Next, we discuss the results, highlighting key trends in delays based on time, day, direction, and streetcar line. Finally, we provide recommendations for riders and policymakers, along with a discussion of limitations and potential areas for future research.


# Data {#sec-data}

## Source and Overview

The raw data used in this paper, was from Open Data Toronto and was extracted using R programming language by @citeR and its packages including `tidyverse` by @citeTidyVerse, `deplyr` by @citeDplyr and `opendatatoronto` by @citeODTPackage. The data consisted of details on the delays. This included the line number on which delay was caused, the time and day, location, reason, amount delayed and gap increased with respect to the next street car scheduled ahead. Apart from these, it also included the bound in which direction the streetcar is heading to and its vehicle number. In @fig-raw, we show a sample of the raw data from Open Data Toronto.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-raw
#| fig-cap: "Sample of the raw data from Open Data Toronto showing delays (minutes) in the TTC streetcar system"

library(tidyverse)
library(dplyr)
data <- read_csv("../data/raw_data/ttc-resource-2024.csv")
cleaned_data <- read_csv("../data/analysis_data/ttc-resource-2024-cleaned.csv")

ggplot(data, aes(x = as.POSIXct(paste(Date, Time)), y = `Min Delay`)) +
  geom_point(aes(color = Incident), size = 3) +
  labs(x = "Date and Time", y = "Delay in Minutes") +
  theme_classic()

```

## Cleaning Data
The data required some basic cleaning, such as dropping empty values. In addition, certain line numbers had very few values. Line numbers with fewer than 100 records were dropped, as they were likely temporary or emergency lines. Despite this, we were still able to cover most of the lines mentioned on the TTC website @citeTTC. Records where the delay was greater than the gap were also removed, as it would not make sense for a streetcar to be delayed while the gap from the next streetcar was smaller.

Upon reviewing the data, we also found several anomalies where the delay exceeded 1,000 minutes. This could either be an error in logging, or an extreme case. Regardless, I have decided to exclude all observations with delays greater than 300 minutes, as it is highly unlikely that a streetcar would be delayed for more than 5 hours on a regular day, and including such outliers could skew the overall analysis.



# Results

After thorough analysis, we observed that the average delay was highest for Eastbound streetcars, while Southbound streetcars had the shortest delays. Overall, streetcars traveling in the North and South directions experienced lower average delays compared to those traveling East and West, as illustrated in @fig-direction. This is consistent with expectations, as Toronto’s nearby suburbs, such as Oshawa, Hamilton, Scarborough, Mississauga, and Brampton, require East-West travel, making those routes busier and therefore more prone to delays. This information is also cross verififed when we find in @sec-linespecific that Line 501 and 506 have the highest average delays which is an East-West bound streetcar.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-direction
#| fig-cap: "Average delay by direction of TTC streetcars"


directions <- c("N", "S", "E", "W")
avg_delay_by_direction <- cleaned_data %>%
    group_by(Bound) %>%
    summarize(avg_delay = mean(`Min Delay`))


ggplot(
    data = avg_delay_by_direction,
    mapping = aes(x =Bound, y = avg_delay)
) +
    geom_point() +
    ylim(10, 20) +
    geom_line() +
    theme_classic() +
    labs(
        x = "Direction",
        y = "Average delay (minutes)"
    )


```

When we examine the average delay of streetcars by line numbers in @fig-line, we find that the 501 line has the longest delays, while the 503 line has the shortest average delays. The significant variation in delays across different streetcar lines makes it valuable for riders to consider when making travel decisions. Often, riders have the option to choose between streetcar numbers when they are between two or three routes or if the stops are not too far apart. However, Google Maps typically displays the closest streetcar, not necessarily the one with the shortest delay.


Note that the bars have been filled based on the number of delays, which could be due either to a lower frequency of streetcars on these lines or to fewer chances of delays. Since we do not have the actual number of times the streetcars operated, we cannot present an adjusted value, and estimating based on frequency might not be entirely accurate. However, being aware of this limitation is still useful for interpreting the data.

On average, Line 506 and 509 had to highest average delay length, while 507 the lowest.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-line
#| fig-cap: "Average delay of streetcars by Line number along with the number of delays caused on each line"

train_numbers <- unique(cleaned_data$Line)
number_of_records_by_train_number <- cleaned_data %>% 
  group_by(Line) %>%
  summarize(train_record_count =  n(), average_train_delay = mean(`Min Delay`))

  
ggplot(
  data = number_of_records_by_train_number,
  mapping = aes(x = factor(train_numbers), y = average_train_delay, 
                fill = train_record_count)
) + 
  geom_bar(stat = "identity") + 
  scale_fill_gradient(low = "lightblue", high = "darkblue") +
  theme_classic() + 
  labs(
    x = "Line Number",
    y = "Average delay (minutes)",
    fill = "No. of Delays"
  )
```

When we examine the delays by time of day in @fig-hour, we notice a spike at 4 AM and 8 PM. This is likely due to driver shift changes. This information is valuable for riders, as they can anticipate potential delays if traveling around these times.

During peak office hours, there is a slight increase in delays, but not significantly. This is likely because streetcars run more frequently during these periods, helping to mitigate delays.
```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-hour
#| fig-cap: "Average delay by hour of the day"

cleaned_data$Hour <- as.numeric(substr(cleaned_data$Time, 1, 2))

avg_delay <- cleaned_data %>% 
  group_by(Hour) %>%
  summarize(Average_Delay = mean(`Min Delay`))

ggplot(avg_delay, aes(x = Hour, y = Average_Delay)) +
  geom_point(color='blue', size=3) +
  geom_line(color = "blue", size = 1) +  
  scale_x_continuous(breaks = 0:24) +         # Set x-axis to show 0 to 24
  labs(x = "Hour of Day", y = "Average Delay (Minutes)") +
  theme_classic()
``` 

When we look at the month of the year and the average delay length in @fig-month, we see spikes in month of March, August, and November. Explaining these trends could be quite interesting. 

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-month
#| fig-cap: "Average delay by month of the year"

cleaned_data$Month <- as.numeric(substr(cleaned_data$Date, 6, 7))

avg_delay_by_month <- cleaned_data %>% 
  group_by(Month) %>%
  summarize(Average_Delay = mean(`Min Delay`))

ggplot(avg_delay_by_month, aes(x = Month, y = Average_Delay)) +
  geom_point(color='blue', size=3) +
  geom_line(color = "blue", size = 1) +  
  scale_x_continuous(breaks = 1:12) +        
  labs(title = "Average Delay by Month", x = "Month of Year", y = "Average Delay (Minutes)") +
  theme_classic()
```

We can also examine the average delay length by day of the week in @fig-week. Surprisingly, there isn't a clear trend across different days. This could be because the primary causes of delays are not traffic-related but due to other factors. Upon investigating the reasons for delays in @fig-reasons, this becomes clearer. The most common reasons for delays are "Diversion," "Overhead," "Collision," and "Held By," none of which are directly related to traffic. Interestingly, "General Delay" is one of the least common reasons, as shown in the graph below.

```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-week
#| fig-cap: "Average delay (minutes) by day of the week in TTC Streetcars"

avg_delay_by_day <- cleaned_data %>%
    group_by(Day) %>%
    summarize(avg_delay = mean(`Min Delay`))

ggplot(avg_delay_by_day, aes(x = Day, y = avg_delay)) +
    geom_bar(stat = "identity", fill = "lightblue") +
    labs( x = "Day", y = "Average Delay (Minutes)") +
    theme_classic()
```



```{r}
#| echo: false
#| eval: true
#| warning: false
#| message: false
#| label: fig-reasons
#| fig-cap: "Reasons for delays in TTC Streetcars"

avg_delay_by_incident <- cleaned_data %>%
    group_by(Incident) %>%
    summarize(avg_delay = mean(`Min Delay`))

ggplot(avg_delay_by_incident, aes(x = reorder(Incident, avg_delay), y = avg_delay)) +
    geom_bar(stat = "identity", fill = "lightcoral") +
    coord_flip() + # Flip for better readability
    labs( x = "Incident Type", y = "Average Delay (Minutes)") +
    theme_classic()
```

# Discussion

The findings from our analysis provide significant insights into the patterns of delays in the TTC streetcar system. These insights can be broken down into a few key areas: the influence of direction, time of day, day of the week, and specific streetcar lines. In this discussion, we will interpret these results in the context of practical use for daily commuters, transit planners, and city infrastructure management.

## Directional Influence on Delays 

The analysis reveals that streetcars traveling in the eastbound and westbound directions experience longer delays compared to those traveling north and south. This could be due to the geographical layout of Toronto, where many busy corridors, such as Queen Street and King Street, run in the east-west direction, connecting major suburbs and districts. These routes are more prone to traffic congestion, roadwork, and external events like construction or parades. And, these routes do not have dedicated lane for streetcars like Spadina does which is a North South Bound streetcar. Conversely, north-south routes may encounter less traffic due to fewer major cross-city connections in those directions.

From a commuter’s perspective, understanding this directional influence can help optimize travel plans. For instance, if a commuter has a choice between an eastbound or northbound route, the latter may offer a more reliable and punctual journey during peak hours.

## Time of Day and Peak Periods

The data indicates that delays spike during specific times of the day, particularly around 4 AM and 8 PM. These times are likely influenced by shift changes or maintenance schedules within the TTC. However, it is worth noting that the expected increase in delays during traditional rush hours (8 AM to 10 AM, 4 PM to 6 PM) was not as pronounced as one might expect. This could be explained by the higher frequency of streetcars during peak hours, which mitigates the overall impact of individual delays.

For transit riders, avoiding travel around the shift change periods may reduce the likelihood of encountering long delays. Meanwhile, the TTC could use this information to reassess staffing or scheduling to minimize disruptions during these critical times.

## Day of the Week and Seasonality

Interestingly, the analysis did not reveal a significant trend in delays across the days of the week. This suggests that the factors causing delays—such as collisions, diversions, or equipment issues—are not strongly tied to weekday traffic patterns. However, we observed a notable spike in delays during the summer months, particularly in June, likely due to seasonal construction and the influx of tourists during the summer festival season.

For city planners, the summer spike in delays highlights the importance of coordinating roadwork schedules and traffic management systems to minimize the impact on transit. For TTC users, planning trips around these periods, or choosing alternate routes, could help avoid unnecessary delays.

## Streetcar Line-Specific Delays {#sec-linespecific}

Certain streetcar lines, such as the 501 Queen and 506 Carlton, exhibited significantly higher delays compared to others. This disparity could be attributed to various factors, including the length of the route, the traffic conditions in areas serviced by these lines, and operational challenges unique to each line.

Commuters familiar with the TTC may benefit from being selective about which streetcar line they choose, especially if they are traveling during periods when delays are more likely. Additionally, transit planners can use this data to focus interventions, such as priority traffic signaling or dedicated streetcar lanes, on the most delay-prone routes to improve overall service reliability.

# Limitations and Further Research

While this study provides valuable insights into TTC streetcar delays, there are a few limitations that must be acknowledged. First, the dataset does not include the total number of streetcars that ran during the period, which prevents us from calculating an adjusted delay frequency relative to the service volume. Furthermore, the analysis does not account for external factors such as weather conditions, which may also influence delay patterns.

In addition, datasets for other TTC transportation modes, such as subways and buses, are also available. Cross-comparing these datasets could provide a more comprehensive view of transit delays, helping commuters make more informed decisions about their travel options. Since TTC tickets are valid for two hours regardless of the transportation type used, this analysis could significantly improve commuters' ability to choose the optimal combination of public transport, leading to a more efficient travel experience.


Future research could expand on this analysis by integrating additional datasets, such as weather reports, traffic data, or real-time transit schedules. A more granular understanding of how these external factors interact with the internal workings of the TTC system could help in developing more targeted solutions to reduce delays.

In summary, our findings suggest that TTC riders can minimize delays by considering the time of travel, direction, and streetcar line. For city and transit authorities, the insights can inform operational improvements and better scheduling practices.


# References


